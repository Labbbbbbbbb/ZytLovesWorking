以下是 YOLOv5 训练脚本中可配置的 **核心超参数** 及其作用的详细解析，按照功能分类整理：

------

### **一、路径与文件参数**

| **参数**   | **类型** | **默认值**       | **作用**                                                     |
| :--------- | :------- | :--------------- | :----------------------------------------------------------- |
| `save_dir` | `Path`   | `runs/train/exp` | 训练结果保存目录（权重、日志、可视化文件）                   |
| `weights`  | `str`    | `''`             | 预训练权重路径（如 `yolov5s.pt`），空字符串表示从零训练      |
| `data`     | `str`    | `data/coco.yaml` | 数据集配置文件路径（定义类别、训练/验证路径等）              |
| `cfg`      | `str`    | `''`             | 模型结构配置文件（如 `yolov5s.yaml`），空字符串表示使用 `weights` 对应配置 |

------

### **二、训练控制参数**

| **参数**     | **类型** | **默认值** | **作用**                                             |
| :----------- | :------- | :--------- | :--------------------------------------------------- |
| `epochs`     | `int`    | `300`      | 训练总轮次                                           |
| `batch_size` | `int`    | `16`       | 每个批次的图像数量（根据GPU显存调整）                |
| `workers`    | `int`    | `8`        | 数据加载的子进程数（建议设为CPU核心数的50-75%）      |
| `freeze`     | `list`   | `[0]`      | 冻结前N层（如 `[0, 1, 2]` 冻结前3层），减少训练参数  |
| `resume`     | `bool`   | `False`    | 是否从上次中断的检查点继续训练（自动查找 `last.pt`） |

------

### **三、数据与模型参数**

| **参数**     | **类型** | **默认值** | **作用**                                       |
| :----------- | :------- | :--------- | :--------------------------------------------- |
| `single_cls` | `bool`   | `False`    | 是否将所有类别视为单一类别（适用于二分类问题） |
| `noval`      | `bool`   | `False`    | 是否跳过验证阶段（仅训练）                     |
| `nosave`     | `bool`   | `False`    | 是否不保存训练结果（调试时使用）               |

------

### **四、超参数进阶配置（hyp.yaml）**

以下参数通常定义在 `data/hyps/hyp.scratch-low.yaml` 等文件中：

#### **1. 优化器参数**

| **参数**        | **默认值** | **作用**                                     |
| :-------------- | :--------- | :------------------------------------------- |
| `lr0`           | `0.01`     | 初始学习率（SGD优化器）                      |
| `lrf`           | `0.01`     | 最终学习率 = `lr0 * lrf`（余弦退火）         |
| `momentum`      | `0.937`    | SGD动量参数                                  |
| `weight_decay`  | `0.0005`   | L2正则化系数                                 |
| `warmup_epochs` | `3.0`      | 学习率预热轮数（从低学习率逐步增加到 `lr0`） |

#### **2. 损失函数权重**

| **参数** | **默认值** | **作用**                 |
| :------- | :--------- | :----------------------- |
| `box`    | `0.05`     | 边界框回归损失权重       |
| `cls`    | `0.5`      | 分类损失权重             |
| `cls_pw` | `1.0`      | 分类损失正样本权重       |
| `obj`    | `1.0`      | 目标存在性损失权重       |
| `obj_pw` | `1.0`      | 目标存在性损失正样本权重 |

#### **3. 数据增强参数**

| **参数**    | **默认值** | **作用**                         |
| :---------- | :--------- | :------------------------------- |
| `hsv_h`     | `0.015`    | 色相（Hue）增强幅度              |
| `hsv_s`     | `0.7`      | 饱和度（Saturation）增强幅度     |
| `hsv_v`     | `0.4`      | 明度（Value）增强幅度            |
| `degrees`   | `0.0`      | 随机旋转角度范围（单位：度）     |
| `translate` | `0.1`      | 随机平移幅度（图像宽高的百分比） |
| `scale`     | `0.5`      | 随机缩放幅度                     |
| `fliplr`    | `0.5`      | 水平翻转概率                     |
| `mosaic`    | `1.0`      | Mosaic数据增强概率（0.0-1.0）    |

------

### **五、特殊训练模式**

| **参数**          | **类型** | **默认值** | **作用**                                     |
| :---------------- | :------- | :--------- | :------------------------------------------- |
| `evolve`          | `bool`   | `False`    | 是否启用超参数进化（自动搜索最优超参数组合） |
| `cos_lr`          | `bool`   | `False`    | 是否使用余弦学习率调度                       |
| `label_smoothing` | `float`  | `0.0`      | 标签平滑系数（推荐0.1-0.2，防止过拟合）      |

------

### **六、参数设置示例**

#### **1. 命令行覆盖默认值**

bash

```
python train.py \
  --epochs 100 \
  --batch-size 32 \
  --data coco.yaml \
  --hyp data/hyps/hyp.scratch-high.yaml \
  --cos_lr  # 启用余弦学习率
```

#### **2. 超参数文件片段（hyp.scratch-low.yaml）**

yaml

```
# 学习率与优化
lr0: 0.01
lrf: 0.01
momentum: 0.937
weight_decay: 0.0005

# 损失权重
box: 0.05
cls: 0.5
obj: 1.0

# 数据增强
hsv_h: 0.015
fliplr: 0.5
mosaic: 1.0
```

------

### **七、关键参数调优建议**

1. **学习率**：
   - 太大（>0.1）：损失震荡/爆炸
   - 太小（<0.0001）：收敛缓慢
   - **推荐**：先用默认值，观察损失曲线调整
2. **批量大小**：
   - 显存不足时降低 `batch_size`，同时等比提高 `lr0`
3. **数据增强**：
   - 小数据集：增大 `mosaic`、`mixup`
   - 大数据集：减少增强幅度
4. **损失权重**：
   - 漏检多：提高 `obj` 权重
   - 误检多：提高 `cls` 权重